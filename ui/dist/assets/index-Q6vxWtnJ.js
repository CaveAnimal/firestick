const i=new Map;async function a(e,r={}){const n=`GET ${e}`,t=r.dedupe||"share";if(t==="share"&&i.has(n))return i.get(n).promise;if(t==="cancel-previous"&&i.has(n)){try{i.get(n).controller.abort()}catch{}i.delete(n)}const s=new AbortController,l=r.signal||s.signal,o=(async()=>{try{const c=await fetch(e,{signal:l});if(!c.ok)throw new Error(`HTTP ${c.status}`);return c.json()}finally{i.delete(n)}})();return i.set(n,{controller:s,promise:o}),o}async function u(e={},r){const n=new URLSearchParams;e.root&&e.root.trim()&&n.set("root",e.root.trim()),e.excludeDirs&&e.excludeDirs.length>0&&n.set("excludeDirs",e.excludeDirs.join(",")),e.excludeGlobs&&e.excludeGlobs.length>0&&n.set("excludeGlobs",e.excludeGlobs.join(","));const t=n.toString(),s=`/api/indexing/run${t?`?${t}`:""}`;return a(s,{dedupe:"cancel-previous"})}async function d(e){return a("/api/indexing/jobs/latest",{dedupe:"share"})}async function g(e=10,r){const t=`/api/indexing/jobs?limit=${e}`;return a(t,{dedupe:"share"})}async function h(e){const r=new URLSearchParams({path:e}).toString();return a(`/api/code/file?${r}`,{dedupe:"cancel-previous"})}async function p(e={}){const r=new URLSearchParams;typeof e.limit=="number"&&r.set("limit",String(e.limit)),e.include&&e.include.length>0&&r.set("include",e.include.join(",")),e.nodeTypes&&e.nodeTypes.length>0&&r.set("nodeTypes",e.nodeTypes.join(","));const n=`/api/graph/enriched${r.toString()?`?${r.toString()}`:""}`;return a(n,{dedupe:"share"})}async function f(e){return a("/api/dashboard/summary",{dedupe:"share"})}export{h as a,f as b,d as c,g as d,p as g,u as s};
